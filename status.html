<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Eppley Data Status</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="static/css/styles.css"/>
</head>
<body>
<header><h1>Eppley Data Status</h1><p class="sub">Auto-updated nightly from this repo’s <code>output/</code> folder.</p></header>
<main><div id="meta" class="small"></div><div id="table"></div></main>
<footer>Right-click a CSV link → “Save link as…” to download directly.</footer>
<script>
async function main(){
  const url='output/status.json?'+Date.now();
  try{
    const res=await fetch(url); const data=await res.json();
    document.getElementById('meta').textContent=`Generated: ${data.generated_at} (UTC) • Repo: ${data.repo}`;
    const rows=data.files||[]; const fmt=n=>(n||0).toLocaleString('en-US');
    const html=`<table><thead><tr><th>File</th><th>Description</th><th>Last Updated (UTC)</th><th>Size</th><th>Total Rows</th><th>New Rows</th><th>Links</th></tr></thead><tbody>${
      rows.map(r=>`<tr>
        <td><code>${r.name}</code><div class="small">${r.exists?'✅ available':'❌ missing'}</div></td>
        <td>${r.label||''}</td>
        <td>${r.updated_at||''}</td>
        <td>${r.size_mb? r.size_mb+' MB':'—'}</td>
        <td>${r.rows? fmt(r.rows):'—'}</td>
        <td>${r.new_rows_since_last_run? '+'+fmt(r.new_rows_since_last_run):'0'}</td>
        <td class="row"><a class="btn" href="${r.download_url}" target="_blank" rel="noopener">Download CSV</a>
        <a class="btn" href="${r.webpage_url}" target="_blank" rel="noopener">View on GitHub</a></td></tr>`).join('')
    }</tbody></table>`;
    document.getElementById('table').innerHTML=html;
  }catch(e){ document.getElementById('table').innerHTML='<p>status.json not found yet. Run the workflows, then refresh.</p>'; }
}
main();
</script>
</body></html>
